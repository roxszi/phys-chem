import{p as C,av as S,q as z,v as H,P as G,aw as U,a4 as k,ax as V,ay as N,D as w,h as L,k as $}from"./framework.BZograE_.js";import{M as J,a as K,L as Q}from"./theme.BPSmqojZ.js";function A(e){return V()?(N(e),!0):!1}const Z=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const j=e=>e!=null,ee=Object.prototype.toString,te=e=>ee.call(e)==="[object Object]",F=()=>{};function q(e,t){function o(...r){return new Promise((l,n)=>{Promise.resolve(e(()=>t.apply(this,r),{fn:t,thisArg:this,args:r})).then(l).catch(n)})}return o}const ne=e=>e();function oe(...e){let t=0,o,r=!0,l=F,n,u,i,s,a;!U(e[0])&&typeof e[0]=="object"?{delay:u,trailing:i=!0,leading:s=!0,rejectOnCancel:a=!1}=e[0]:[u,i=!0,s=!0,a=!1]=e;const p=()=>{o&&(clearTimeout(o),o=void 0,l(),l=F)};return m=>{const d=S(u),v=Date.now()-t,E=()=>n=m();return p(),d<=0?(t=Date.now(),E()):(v>d&&(s||!r)?(t=Date.now(),E()):i&&(n=new Promise((f,h)=>{l=a?h:f,o=setTimeout(()=>{t=Date.now(),r=!0,f(E()),p()},Math.max(0,d-v))})),!s&&!o&&(o=setTimeout(()=>r=!0,d)),r=!1,n)}}function B(e){return Array.isArray(e)?e:[e]}function ie(e){return k()}function le(e,t=200,o=!1,r=!0,l=!1){return q(oe(t,o,r,l),e)}function Me(e,t=200,o=!0,r=!0){if(t<=0)return e;const l=C(S(e)),n=le(()=>{l.value=e.value},t,o,r);return z(e,()=>n()),l}function se(e,t=!0,o){ie()?H(e,o):t?e():G(e)}function re(e,t,o){return z(e,t,{...o,immediate:!0})}const R=Z?window:void 0;function I(e){var t;const o=S(e);return(t=o==null?void 0:o.$el)!=null?t:o}function D(...e){const t=[],o=()=>{t.forEach(i=>i()),t.length=0},r=(i,s,a,p)=>(i.addEventListener(s,a,p),()=>i.removeEventListener(s,a,p)),l=L(()=>{const i=B(S(e[0])).filter(s=>s!=null);return i.every(s=>typeof s!="string")?i:void 0}),n=re(()=>{var i,s;return[(s=(i=l.value)==null?void 0:i.map(a=>I(a)))!=null?s:[R].filter(a=>a!=null),B(S(l.value?e[1]:e[0])),B($(l.value?e[2]:e[1])),S(l.value?e[3]:e[2])]},([i,s,a,p])=>{if(o(),!(i!=null&&i.length)||!(s!=null&&s.length)||!(a!=null&&a.length))return;const g=te(p)?{...p}:p;t.push(...i.flatMap(m=>s.flatMap(d=>a.map(v=>r(m,d,v,g)))))},{flush:"post"}),u=()=>{n(),o()};return A(o),u}function ue(){const e=w(!1),t=k();return t&&H(()=>{e.value=!0},t),e}function T(e){const t=ue();return L(()=>(t.value,!!e()))}function ae(e,t,o={}){const{window:r=R,...l}=o;let n;const u=T(()=>r&&"MutationObserver"in r),i=()=>{n&&(n.disconnect(),n=void 0)},s=L(()=>{const m=S(e),d=B(m).map(I).filter(j);return new Set(d)}),a=z(s,m=>{i(),u.value&&m.size&&(n=new MutationObserver(t),m.forEach(d=>n.observe(d,l)))},{immediate:!0,flush:"post"}),p=()=>n==null?void 0:n.takeRecords(),g=()=>{a(),i()};return A(g),{isSupported:u,stop:g,takeRecords:p}}const ce=500,fe=10;function Ee(e,t,o){var r,l;const n=L(()=>I(e));let u,i;function s(){u&&(clearTimeout(u),u=void 0),i=void 0}function a(f){return ce}function p(f){s()}function g(f){var h,y,b;(h=void 0)!=null&&h.self&&f.target!==n.value||(s(),(y=void 0)!=null&&y.prevent&&f.preventDefault(),(b=void 0)!=null&&b.stop&&f.stopPropagation(),i={x:f.x,y:f.y},f.timeStamp,u=setTimeout(()=>{t(f)},a()))}function m(f){var h,y,b,P;if((h=void 0)!=null&&h.self&&f.target!==n.value||!i)return;(y=void 0)!=null&&y.prevent&&f.preventDefault(),(b=void 0)!=null&&b.stop&&f.stopPropagation();const M=f.x-i.x,x=f.y-i.y;Math.sqrt(M*M+x*x)>=((P=void 0)!=null?P:fe)&&s()}const d={capture:(r=void 0)==null?void 0:r.capture,once:(l=void 0)==null?void 0:l.once},v=[D(n,"pointerdown",g,d),D(n,"pointermove",m,d),D(n,["pointerup","pointerleave"],p,d)];return()=>v.forEach(f=>f())}function De(e={}){const{window:t=R,requestPermissions:o=!1,eventFilter:r=ne}=e,l=T(()=>typeof DeviceMotionEvent<"u"),n=T(()=>l.value&&"requestPermission"in DeviceMotionEvent&&typeof DeviceMotionEvent.requestPermission=="function"),u=w(!1),i=C({x:null,y:null,z:null}),s=C({alpha:null,beta:null,gamma:null}),a=w(0),p=C({x:null,y:null,z:null});function g(){if(t){const d=q(r,v=>{var E,f,h,y,b,P,M,x,c;i.value={x:((E=v.acceleration)==null?void 0:E.x)||null,y:((f=v.acceleration)==null?void 0:f.y)||null,z:((h=v.acceleration)==null?void 0:h.z)||null},p.value={x:((y=v.accelerationIncludingGravity)==null?void 0:y.x)||null,y:((b=v.accelerationIncludingGravity)==null?void 0:b.y)||null,z:((P=v.accelerationIncludingGravity)==null?void 0:P.z)||null},s.value={alpha:((M=v.rotationRate)==null?void 0:M.alpha)||null,beta:((x=v.rotationRate)==null?void 0:x.beta)||null,gamma:((c=v.rotationRate)==null?void 0:c.gamma)||null},a.value=v.interval});D(t,"devicemotion",d,{passive:!0})}}const m=async()=>{if(n.value||(u.value=!0),!u.value&&n.value){const d=DeviceMotionEvent.requestPermission;try{await d()==="granted"&&(u.value=!0,g())}catch(v){console.error(v)}}};return l.value&&(o&&n.value?m().then(()=>g()):g()),{acceleration:i,accelerationIncludingGravity:p,rotationRate:s,interval:a,isSupported:l,requirePermissions:n,ensurePermissions:m,permissionGranted:u}}function xe(e={}){const{window:t=R}=e,o=T(()=>t&&"DeviceOrientationEvent"in t),r=w(!1),l=w(null),n=w(null),u=w(null);return t&&o.value&&D(t,"deviceorientation",i=>{r.value=i.absolute,l.value=i.alpha,n.value=i.beta,u.value=i.gamma},{passive:!0}),{isSupported:o,isAbsolute:r,alpha:l,beta:n,gamma:u}}function de(e,t,o={}){const{window:r=R,...l}=o;let n;const u=T(()=>r&&"ResizeObserver"in r),i=()=>{n&&(n.disconnect(),n=void 0)},s=L(()=>{const g=S(e);return Array.isArray(g)?g.map(m=>I(m)):[I(g)]}),a=z(s,g=>{if(i(),u.value&&r){n=new ResizeObserver(t);for(const m of g)m&&n.observe(m,l)}},{immediate:!0,flush:"post"}),p=()=>{i(),a()};return A(p),{isSupported:u,stop:p}}const ve={page:e=>[e.pageX,e.pageY],client:e=>[e.clientX,e.clientY],screen:e=>[e.screenX,e.screenY],movement:e=>e instanceof MouseEvent?[e.movementX,e.movementY]:null};function pe(e={}){const{type:t="page",touch:o=!0,resetOnTouchEnds:r=!1,initialValue:l={x:0,y:0},window:n=R,target:u=n,scroll:i=!0,eventFilter:s}=e;let a=null,p=0,g=0;const m=w(l.x),d=w(l.y),v=w(null),E=typeof t=="function"?t:ve[t],f=c=>{const O=E(c);a=c,O&&([m.value,d.value]=O,v.value="mouse"),n&&(p=n.scrollX,g=n.scrollY)},h=c=>{if(c.touches.length>0){const O=E(c.touches[0]);O&&([m.value,d.value]=O,v.value="touch")}},y=()=>{if(!a||!n)return;const c=E(a);a instanceof MouseEvent&&c&&(m.value=c[0]+n.scrollX-p,d.value=c[1]+n.scrollY-g)},b=()=>{m.value=l.x,d.value=l.y},P=s?c=>s(()=>f(c),{}):c=>f(c),M=s?c=>s(()=>h(c),{}):c=>h(c),x=s?()=>s(()=>y(),{}):()=>y();if(u){const c={passive:!0};D(u,["mousemove","dragover"],P,c),o&&t!=="movement"&&(D(u,["touchstart","touchmove"],M,c),r&&D(u,"touchend",b,c)),i&&t==="page"&&D(n,"scroll",x,c)}return{x:m,y:d,sourceType:v}}function Pe(e,t={}){const{windowResize:o=!0,windowScroll:r=!0,handleOutside:l=!0,window:n=R}=t,u=t.type||"page",{x:i,y:s,sourceType:a}=pe(t),p=w(e??(n==null?void 0:n.document.body)),g=w(0),m=w(0),d=w(0),v=w(0),E=w(0),f=w(0),h=w(!0);function y(){if(!n)return;const M=I(p);if(!M||!(M instanceof Element))return;const{left:x,top:c,width:O,height:W}=M.getBoundingClientRect();d.value=x+(u==="page"?n.pageXOffset:0),v.value=c+(u==="page"?n.pageYOffset:0),E.value=W,f.value=O;const Y=i.value-d.value,X=s.value-v.value;h.value=O===0||W===0||Y<0||X<0||Y>O||X>W,(l||!h.value)&&(g.value=Y,m.value=X)}const b=[];function P(){b.forEach(M=>M()),b.length=0}if(se(()=>{y()}),n){const{stop:M}=de(p,y),{stop:x}=ae(p,y,{attributeFilter:["style","class"]}),c=z([p,i,s],y);b.push(M,x,c),D(document,"mouseleave",()=>h.value=!0,{passive:!0}),r&&b.push(D("scroll",y,{capture:!0,passive:!0})),o&&b.push(D("resize",y,{passive:!0}))}return{x:i,y:s,sourceType:a,elementX:g,elementY:m,elementPositionX:d,elementPositionY:v,elementHeight:E,elementWidth:f,isOutside:h,stop:P}}const _={loadingInstance:null,dialogInstance:null};function me(e="加载中..."){_.loadingInstance&&_.loadingInstance.hide(),e!==!1&&(_.loadingInstance=Q({delay:0,fullscreen:!0,indicator:!0,inheritColor:!1,loading:!0,preventScrollThrough:!0,showOverlay:!0,size:"large",text:e,zIndex:3500}))}function ge(e){_.dialogInstance&&_.dialogInstance.destroy(),typeof e=="string"&&(e={body:e});const{theme:t="info",header:o,body:r,confirmBtn:l=void 0,onConfirmCallBack:n=()=>{}}=e,u=e.onConfirmCallBack?e.cancelBtn||void 0:null;_.dialogInstance=K({mode:"modal",placement:"center",theme:t,closeBtn:!1,destroyOnClose:!0,header:o,body:r,footer:!0,confirmBtn:l,confirmLoading:!1,confirmOnEnter:!0,cancelBtn:u,onConfirm:()=>{n(),_.dialogInstance.destroy()}})}function he(e){typeof e=="string"&&(e={content:e});const{theme:t="info",closeBtn:o=!1,content:r,duration:l=1500}=e;J(t,{closeBtn:o,content:r,icon:!0,placement:"center"},l)}function ye(e="程序报错",t,o){if(console.log(e,t),o)o(t);else throw new Error(e,{cause:t})}const Oe={loading:me,dialog:ge,message:he,error:ye};export{le as a,De as b,xe as c,Oe as m,Ee as o,Me as r,Pe as u};
